{"version":3,"sources":["../../../src/routers/api/match.js"],"names":["router","Router","get","req","res","next","pageIndex","query","pageSize","requestHelper","frequency","resp","json","error","memberId","session","user","member","id","post","matchId","body","module","exports"],"mappings":";;;;;;;;;;;;;;AAIA;;;;AACA;;;;;;AALA;;;;AAOA,IAAIA,SAAS,kBAAQC,MAAR,EAAb;;AAEA;;;AAGAD,OAAOE,GAAP,CAAW,MAAX;AAAA,0EAAkB,iBAAOC,GAAP,EAAWC,GAAX,EAAeC,IAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAENC,iCAFM,GAEIH,IAAII,KAAJ,CAAUD,SAFd;AAGNE,gCAHM,GAGGL,IAAII,KAAJ,CAAUC,QAHb;AAAA;AAAA,+BAKKC,cAAcP,GAAd,CAAkB;AAC7B,0CAAa,cADgB;AAE7B,0CAAa,OAFgB;AAG7B,sCAAS,MAHoB;AAI7B,oCAAO;AACJQ,2CAAU,CADN,EACQ;AACZJ,oDAFI;AAGJE;AAHI;AAJsB,yBAAlB,CALL;;AAAA;AAKNG,4BALM;;;AAgBVP,4BAAIQ,IAAJ,CAASD,IAAT;;AAhBU;AAAA;;AAAA;AAAA;AAAA;;AAmBV,yCAAOE,KAAP,2BAAqC,qCAArC;;AAnBU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAlB;;AAAA;AAAA;AAAA;AAAA;;AAuBA;;;AAGAb,OAAOE,GAAP,CAAW,SAAX;AAAA,2EAAqB,kBAAOC,GAAP,EAAWC,GAAX,EAAeC,IAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAETC,iCAFS,GAECH,IAAII,KAAJ,CAAUD,SAFX;AAGTE,gCAHS,GAGAL,IAAII,KAAJ,CAAUC,QAHV;AAITM,gCAJS,GAIAX,IAAIY,OAAJ,CAAYC,IAAZ,CAAiBC,MAAjB,CAAwBC,EAJxB;AAAA;AAAA,+BAMET,cAAcP,GAAd,CAAkB;AAC7B,0CAAa,cADgB;AAE7B,0CAAa,OAFgB;AAG7B,sCAAS,QAHoB;AAI7B,oCAAO;AACJI,oDADI;AAEJE,kDAFI;AAGJM;AAHI;AAJsB,yBAAlB,CANF;;AAAA;AAMTH,4BANS;;;AAiBbP,4BAAIQ,IAAJ,CAASD,IAAT;;AAjBa;AAAA;;AAAA;AAAA;AAAA;;AAoBb,yCAAOE,KAAP,8BAAwC,sCAAxC;;AApBa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAArB;;AAAA;AAAA;AAAA;AAAA;;AAwBA;;;AAGAb,OAAOmB,IAAP,CAAY,QAAZ;AAAA,2EAAqB,kBAAOhB,GAAP,EAAWC,GAAX,EAAeC,IAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAETS,gCAFS,GAEAX,IAAIY,OAAJ,CAAYC,IAAZ,CAAiBC,MAAjB,CAAwBC,EAFxB;AAGTE,+BAHS,GAGCjB,IAAIkB,IAAJ,CAASD,OAHV;AAAA;AAAA,+BAIEX,cAAcU,IAAd,CAAmB;AAC9B,0CAAa,cADiB;AAE9B,0CAAa,OAFiB;AAG9B,sCAAS,OAHqB;AAI9B,oCAAO;AACJL,kDADI;AAEJM;AAFI;AAJuB,yBAAnB,CAJF;;AAAA;AAITT,4BAJS;;;AAcbP,4BAAIQ,IAAJ,CAASD,IAAT;;AAda;AAAA;;AAAA;AAAA;AAAA;;AAiBb,yCAAOE,KAAP,6BAAuC,sCAAvC;;AAjBa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAArB;;AAAA;AAAA;AAAA;AAAA;;AAqBAS,OAAOC,OAAP,GAAiBvB,MAAjB","file":"match.js","sourcesContent":["/**\n * desc:比赛相关的api 定义\n */\n\nimport express from 'express'\nimport logger from '../../utils/logger'\n\nlet router = express.Router()\n\n/**\n * 获取赛事信息\n */\nrouter.get(\"/get\",async (req,res,next)=>{\n    try{\n        let pageIndex=req.query.pageIndex\n        let pageSize=req.query.pageSize\n\n        let resp=await requestHelper.get({\n            \"moduleName\":\"hulk_service\",\n            \"controller\":\"match\",\n            \"action\":\"find\",\n            \"data\":{\n               frequency:1,//平日赛\n               pageIndex,\n               pageSize\n            }\n        })\n\n        res.json(resp)\n\n    }catch(e){\n        logger.error(`api_match_get_error=>${JSON.stringify(e)}`)\n    }\n})\n\n/**\n * 获取比赛结果\n */\nrouter.get(\"/result\",async (req,res,next)=>{\n    try{\n        let pageIndex=req.query.pageIndex\n        let pageSize=req.query.pageSize\n        let memberId=req.session.user.member.id\n\n        let resp=await requestHelper.get({\n            \"moduleName\":\"hulk_service\",\n            \"controller\":\"match\",\n            \"action\":\"result\",\n            \"data\":{\n               pageIndex,\n               pageSize,\n               memberId\n            }\n        })\n\n        res.json(resp)\n\n    }catch(e){\n        logger.error(`api_match_result_error=>${JSON.stringify(e)}`)\n    }\n})\n\n/**\n * 报名参赛\n */\nrouter.post(\"/apply\",async (req,res,next)=>{\n    try{\n        let memberId=req.session.user.member.id\n        let matchId = req.body.matchId\n        let resp=await requestHelper.post({\n            \"moduleName\":\"hulk_service\",\n            \"controller\":\"match\",\n            \"action\":\"apply\",\n            \"data\":{\n               memberId,\n               matchId\n            }\n        })\n\n        res.json(resp);\n\n    }catch(e){\n        logger.error(`api_match_apply_error=>${JSON.stringify(e)}`)\n    }\n})\n\nmodule.exports = router"]}