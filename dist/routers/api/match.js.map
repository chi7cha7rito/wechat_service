{"version":3,"sources":["../../../src/routers/api/match.js"],"names":["router","Router","get","req","res","next","pageIndex","query","pageSize","requestHelper","applyOnline","status","startClosing","format","resp","json","error","memberId","session","user","member","id","post","matchId","body","module","exports"],"mappings":";;;;;;;;;;AAIA;;;;AACA;;;;AACA;;;;;;AACA,IAAIA,SAAS,kBAAQC,MAAR,EAAb;;AAEA;;;AATA;;;;AAYAD,OAAOE,GAAP,CAAW,MAAX;AAAA,0EAAkB,iBAAOC,GAAP,EAAWC,GAAX,EAAeC,IAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAENC,iCAFM,GAEIH,IAAII,KAAJ,CAAUD,SAFd;AAGNE,gCAHM,GAGGL,IAAII,KAAJ,CAAUC,QAHb;AAAA;AAAA,+BAKKC,cAAcP,GAAd,CAAkB;AAC7B,0CAAa,cADgB;AAE7B,0CAAa,OAFgB;AAG7B,sCAAS,MAHoB;AAI7B,oCAAO;AACJQ,6CAAY,IADR;AAEJC,wCAAO,CAFH;AAGJC,8CAAa,wBAASC,MAAT,EAHT;AAIJP,oDAJI;AAKJE;AALI;AAJsB,yBAAlB,CALL;;AAAA;AAKNM,4BALM;;;AAkBVV,4BAAIW,IAAJ,CAASD,IAAT;;AAlBU;AAAA;;AAAA;AAAA;AAAA;;AAqBV,yCAAOE,KAAP;;AArBU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAlB;;AAAA;AAAA;AAAA;AAAA;;AAyBA;;;AAGAhB,OAAOE,GAAP,CAAW,SAAX;AAAA,2EAAqB,kBAAOC,GAAP,EAAWC,GAAX,EAAeC,IAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAETC,iCAFS,GAECH,IAAII,KAAJ,CAAUD,SAFX;AAGTE,gCAHS,GAGAL,IAAII,KAAJ,CAAUC,QAHV;AAITS,gCAJS,GAIAd,IAAIe,OAAJ,CAAYC,IAAZ,CAAiBC,MAAjB,CAAwBC,EAJxB;AAAA;AAAA,+BAMEZ,cAAcP,GAAd,CAAkB;AAC7B,0CAAa,cADgB;AAE7B,0CAAa,OAFgB;AAG7B,sCAAS,QAHoB;AAI7B,oCAAO;AACJI,oDADI;AAEJE,kDAFI;AAGJS;AAHI;AAJsB,yBAAlB,CANF;;AAAA;AAMTH,4BANS;;;AAiBbV,4BAAIW,IAAJ,CAASD,IAAT;;AAjBa;AAAA;;AAAA;AAAA;AAAA;;AAoBb,yCAAOE,KAAP;;AApBa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAArB;;AAAA;AAAA;AAAA;AAAA;;AAwBA;;;AAGAhB,OAAOsB,IAAP,CAAY,QAAZ;AAAA,2EAAqB,kBAAOnB,GAAP,EAAWC,GAAX,EAAeC,IAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAETY,gCAFS,GAEAd,IAAIe,OAAJ,CAAYC,IAAZ,CAAiBC,MAAjB,CAAwBC,EAFxB;AAGTE,+BAHS,GAGCpB,IAAIqB,IAAJ,CAASD,OAHV;AAAA;AAAA,+BAIEd,cAAca,IAAd,CAAmB;AAC9B,0CAAa,cADiB;AAE9B,0CAAa,OAFiB;AAG9B,sCAAS,OAHqB;AAI9B,oCAAO;AACJL,kDADI;AAEJM;AAFI;AAJuB,yBAAnB,CAJF;;AAAA;AAITT,4BAJS;;;AAcbV,4BAAIW,IAAJ,CAASD,IAAT;;AAda;AAAA;;AAAA;AAAA;AAAA;;AAiBb,yCAAOE,KAAP;;AAjBa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAArB;;AAAA;AAAA;AAAA;AAAA;;AAqBAS,OAAOC,OAAP,GAAiB1B,MAAjB","file":"match.js","sourcesContent":["/**\n * desc:比赛相关的api 定义\n */\n\nimport express from 'express'\nimport logger from '../../utils/logger'\nimport moment from 'moment'\nlet router = express.Router()\n\n/**\n * 获取赛事信息\n */\nrouter.get(\"/get\",async (req,res,next)=>{\n    try{\n        let pageIndex=req.query.pageIndex\n        let pageSize=req.query.pageSize\n\n        let resp=await requestHelper.get({\n            \"moduleName\":\"hulk_service\",\n            \"controller\":\"match\",\n            \"action\":\"find\",\n            \"data\":{\n               applyOnline:true,\n               status:1,\n               startClosing:moment().format(),\n               pageIndex,\n               pageSize\n            }\n        })\n\n        res.json(resp)\n\n    }catch(e){\n        logger.error(`api_match_get_error=>${e}`)\n    }\n})\n\n/**\n * 获取比赛结果\n */\nrouter.get(\"/result\",async (req,res,next)=>{\n    try{\n        let pageIndex=req.query.pageIndex\n        let pageSize=req.query.pageSize\n        let memberId=req.session.user.member.id\n\n        let resp=await requestHelper.get({\n            \"moduleName\":\"hulk_service\",\n            \"controller\":\"match\",\n            \"action\":\"result\",\n            \"data\":{\n               pageIndex,\n               pageSize,\n               memberId\n            }\n        })\n\n        res.json(resp)\n\n    }catch(e){\n        logger.error(`api_match_result_error=>${e}`)\n    }\n})\n\n/**\n * 报名参赛\n */\nrouter.post(\"/apply\",async (req,res,next)=>{\n    try{\n        let memberId=req.session.user.member.id\n        let matchId = req.body.matchId\n        let resp=await requestHelper.post({\n            \"moduleName\":\"hulk_service\",\n            \"controller\":\"match\",\n            \"action\":\"apply\",\n            \"data\":{\n               memberId,\n               matchId\n            }\n        })\n\n        res.json(resp);\n\n    }catch(e){\n        logger.error(`api_match_apply_error=>${e}`)\n    }\n})\n\nmodule.exports = router"]}