function MatchController(){Controller.call(this),this.pageSize=5,this.initPage()}!function(e){e.fn.pullload=function(a){var l=e.extend({},e.fn.pullload.defaults,a);return this.each(function(){var a=this;e(this).attr("requestable","true"),e(l.handler).on("scroll.pullload",function(){var i=e(window).height(),s=e(window).scrollTop(),t=e(a).children().last(),o=t.height()+t.offset().top+l.threshold;i+s>o&&"true"==e(a).attr("requestable")&&e.fn.pullload.request(a,l)})})},e.fn.pullload.request=function(a,l){e(a).attr("requestable","false");var i=l.crossDomain?"jsonp":"json",s=l.crossDomain?"GET":l.requestType,t=e(a).data("page-index")||2,o={};"0"==l.mode?o[l.requestLoadedKey]=e(a).children().size():(o[l.pageSizeKey]=l.pageSize,o[l.pageIndexKey]=t),e.fn.pullload.tips(l.loadingTips,a,l);try{e.ajax({url:l.apiUrl,type:s,dataType:i,data:o,success:function(i){return l.callback&&l.callback(i),"1"==l.mode&&e(a).data("page-index",++t),e.fn.pullload.getTotalCount(i,l.countKey)?void(e.fn.pullload.getTotalCount(i,l.countKey)<=e(a).children().size()?(e.fn.pullload.tips(l.lastLoadedTips,a,l),e(l.handler).off("scroll.pullload")):(e(a).attr("requestable","true"),e.fn.pullload.closeTips(a,l))):void e.fn.pullload.tips("您的数据接口好像没有给出总条数嘛！",a,l)},error:function(i){e.fn.pullload.tips(l.loadFailedTips,a,l)}})}catch(n){e.fn.pullload.tips("错误名称："+n.name+"\n错误描述："+n.message)}},e.fn.pullload.tips=function(a,l,i){i.isShowLoadingTips&&(0===e(l).next("."+i.tipsClassName).size()&&e(l).after('<div class="'+i.tipsClassName+'"></div>'),e(l).next("."+i.tipsClassName).html(a),e(l).next("."+i.tipsClassName).slideDown(100))},e.fn.pullload.closeTips=function(a,l){l.isShowLoadingTips&&e(a).next("."+l.tipsClassName).slideUp(100)},e.fn.pullload.getTotalCount=function(e,a){var l=[];return a.indexOf(".")>0&&(l=a.split("."),l[0]&&l[1])?e[l[0]][l[1]]:e[a]},e.fn.pullload.defaults={handler:window,apiUrl:"",crossDoman:!1,requestType:"GET",callback:null,requestLoadedKey:"loaded",countKey:"count",tipsClassName:"data-status",loadingTips:"数据加载中...",lastLoadedTips:"已经加载到最后一页！",loadFailedTips:"数据加载失败，请重试！",threshold:50,isShowLoadingTips:!1,pageIndexKey:"pageIndex",pageSizeKey:"pageSize",pageSize:"10",mode:"1"}}(jQuery),define("components/pullload.js",function(){}),MatchController.prototype.initPage=function(){var e=this;e.request(e.apiUrl.match.getAll,{pageIndex:1,pageSize:e.pageSize},{showLoadingTips:!0,process:function(a){e.renderList(a),e.initPullLoad()}})},MatchController.prototype.initPullLoad=function(){var e=this;require(["components/pullload.js"],function(){$(".match-list").pullload({apiUrl:e.apiUrl.match.getAll,threshold:15,crossDoman:!1,pageSize:e.pageSize,countKey:"data.count",callback:function(a){e.renderList(a.data,!0)}})})},MatchController.prototype.renderList=function(e,a){var l=this,i=$(".match-list");if(!a&&(i.empty(),!e.count)){var s='<div class="weui-loadmore weui-loadmore_line">';s+='<span class="weui-loadmore__tips">暂无数据</span>',s+="</div>",i.append(s)}$.each(e.rows,function(e,a){i.append(l.getItem(a))})},MatchController.prototype.getItem=function(e){var a=this,l=0;$.each(e.matchConfig.matchPrices,function(e,a){1===a.type.val&&(l=a.price)});var i="";return i+='<div class="weui-form-preview">',i+='<div class="weui-form-preview__hd">',i+='<div class="weui-form-preview__item">',i+='<label class="weui-form-preview__label">赛事名称</label>',i+='<em class="weui-form-preview__value name">'+e.matchConfig.name+"</em>",i+="</div>",i+="</div>",i+='<div class="weui-form-preview__bd">',i+='<div class="weui-form-preview__item">',i+='<label class="weui-form-preview__label">类型</label>',i+='<span class="weui-form-preview__value">'+e.matchConfig.Type.name+"【"+e.matchConfig.subType.name+"】</span>",i+="</div>",i+='<div class="weui-form-preview__item">',i+='<label class="weui-form-preview__label">举办方</label>',i+='<span class="weui-form-preview__value">'+e.matchConfig.holder+"</span>",i+="</div>",i+='<div class="weui-form-preview__item">',i+='<label class="weui-form-preview__label">门票费用</label>',i+='<span class="weui-form-preview__value price">¥'+l+"</span>",i+="</div>",i+='<div class="weui-form-preview__item">',i+='<label class="weui-form-preview__label">报名截止</label>',i+='<span class="weui-form-preview__value">'+a.utcToLocal(e.closingDatetime)+"</span>",i+="</div>",i+='<div class="weui-form-preview__item">',i+='<label class="weui-form-preview__label">比赛时间</label>',i+='<span class="weui-form-preview__value">'+a.utcToLocal(e.openingDatetime)+"</span>",i+="</div>",i+='<div class="weui-form-preview__item">',i+='<label class="weui-form-preview__label">参赛人数</label>',i+='<span class="weui-form-preview__value">'+e.attendances.length+"</span>",i+="</div>",i+='<div class="weui-form-preview__item">',i+='<label class="weui-form-preview__label">赛事介绍</label>',i+='<span class="weui-form-preview__value">'+e.matchConfig.description+"</span>",i+="</div>",i+="</div>",i+='<div class="weui-form-preview__ft">',i+='<a class="weui-form-preview__btn weui-form-preview__btn_primary" href="rewards?matchConfigId='+e.matchConfigId+"&matchName="+e.matchConfig.name+'">奖励</a>',i+="</div>",i+="</div>",$(i)},$(function(){new MatchController}),define("match/list",function(){});