function ConsumeController(){Controller.call(this),this.pageSize=10,this.initPage()}!function(e){e.fn.pullload=function(l){var a=e.extend({},e.fn.pullload.defaults,l);return this.each(function(){var l=this;e(this).attr("requestable","true"),e(a.handler).on("scroll.pullload",function(){var i=e(window).height(),o=e(window).scrollTop(),t=e(l).children().last(),s=t.height()+t.offset().top+a.threshold;i+o>s&&"true"==e(l).attr("requestable")&&e.fn.pullload.request(l,a)})})},e.fn.pullload.request=function(l,a){e(l).attr("requestable","false");var i=a.crossDomain?"jsonp":"json",o=a.crossDomain?"GET":a.requestType,t=e(l).data("page-index")||2,s={};"0"==a.mode?s[a.requestLoadedKey]=e(l).children().size():(s[a.pageSizeKey]=a.pageSize,s[a.pageIndexKey]=t),e.fn.pullload.tips(a.loadingTips,l,a);try{e.ajax({url:a.apiUrl,type:o,dataType:i,data:s,success:function(i){return a.callback&&a.callback(i),"1"==a.mode&&e(l).data("page-index",++t),e.fn.pullload.getTotalCount(i,a.countKey)?void(e.fn.pullload.getTotalCount(i,a.countKey)<=e(l).children().size()?(e.fn.pullload.tips(a.lastLoadedTips,l,a),e(a.handler).off("scroll.pullload")):(e(l).attr("requestable","true"),e.fn.pullload.closeTips(l,a))):void e.fn.pullload.tips("您的数据接口好像没有给出总条数嘛！",l,a)},error:function(i){e.fn.pullload.tips(a.loadFailedTips,l,a)}})}catch(n){e.fn.pullload.tips("错误名称："+n.name+"\n错误描述："+n.message)}},e.fn.pullload.tips=function(l,a,i){i.isShowLoadingTips&&(0===e(a).next("."+i.tipsClassName).size()&&e(a).after('<div class="'+i.tipsClassName+'"></div>'),e(a).next("."+i.tipsClassName).html(l),e(a).next("."+i.tipsClassName).slideDown(100))},e.fn.pullload.closeTips=function(l,a){a.isShowLoadingTips&&e(l).next("."+a.tipsClassName).slideUp(100)},e.fn.pullload.getTotalCount=function(e,l){var a=[];return l.indexOf(".")>0&&(a=l.split("."),a[0]&&a[1])?e[a[0]][a[1]]:e[l]},e.fn.pullload.defaults={handler:window,apiUrl:"",crossDoman:!1,requestType:"GET",callback:null,requestLoadedKey:"loaded",countKey:"count",tipsClassName:"data-status",loadingTips:"数据加载中...",lastLoadedTips:"已经加载到最后一页！",loadFailedTips:"数据加载失败，请重试！",threshold:50,isShowLoadingTips:!1,pageIndexKey:"pageIndex",pageSizeKey:"pageSize",pageSize:"10",mode:"1"}}(jQuery),define("components/pullload.js",function(){}),ConsumeController.prototype.initPage=function(){var e=this;e.request(e.apiUrl.balance.get,{pageIndex:1,pageSize:e.pageSize},{showLoadingTips:!0,process:function(l){e.renderList(l),e.initPullLoad()}})},ConsumeController.prototype.initPullLoad=function(){var e=this;require(["components/pullload.js"],function(){$(".balance-list").pullload({apiUrl:e.apiUrl.balance.get,threshold:15,crossDoman:!1,pageSize:e.pageSize,countKey:"data.count",callback:function(l){e.renderList(l.data,!0)}})})},ConsumeController.prototype.renderList=function(e,l){var a=this,i=$(".balance-list");if(!l&&(i.empty(),!e.count)){var o='<div class="weui-loadmore weui-loadmore_line">';o+='<span class="weui-loadmore__tips">暂无数据</span>',o+="</div>",i.append(o)}$.each(e.rows,function(e,l){i.append(a.getItem(l))})},ConsumeController.prototype.getItem=function(e){var l=this,a=e.isPositive?"positive":"negative",i="";return i+='<div class="weui-form-preview">',i+='<div class="weui-form-preview__hd">',i+='<div class="weui-form-preview__item">',i+='<label class="weui-form-preview__label">金额</label>',i+='<em class="weui-form-preview__value '+a+'">¥'+e.amount+"</em>",i+="</div>",i+="</div>",i+='<div class="weui-form-preview__bd">',i+='<div class="weui-form-preview__item">',i+='<label class="weui-form-preview__label">用途/来源</label>',i+='<span class="weui-form-preview__value status">'+e.source.name+"</span>",i+="</div>",i+='<div class="weui-form-preview__item">',i+='<label class="weui-form-preview__label">时间</label>',i+='<span class="weui-form-preview__value">'+l.utcToLocal(e.createdAt)+"</span>",i+="</div>",i+="</div>",i+="</div>",$(i)},$(function(){new ConsumeController}),define("personal/balance",function(){});