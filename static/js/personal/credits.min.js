function CreditsController(){Controller.call(this),this.pageSize=10,this.initPage()}!function(e){e.fn.pullload=function(t){var l=e.extend({},e.fn.pullload.defaults,t);return this.each(function(){var t=this;e(this).attr("requestable","true"),e(l.handler).on("scroll.pullload",function(){var a=e(window).height(),o=e(window).scrollTop(),i=e(t).children().last(),n=i.height()+i.offset().top+l.threshold;a+o>n&&"true"==e(t).attr("requestable")&&e.fn.pullload.request(t,l)})})},e.fn.pullload.request=function(t,l){e(t).attr("requestable","false");var a=l.crossDomain?"jsonp":"json",o=l.crossDomain?"GET":l.requestType,i=e(t).data("page-index")||2,n={};"0"==l.mode?n[l.requestLoadedKey]=e(t).children().size():(n[l.pageSizeKey]=l.pageSize,n[l.pageIndexKey]=i),e.fn.pullload.tips(l.loadingTips,t,l);try{e.ajax({url:l.apiUrl,type:o,dataType:a,data:n,success:function(a){return l.callback&&l.callback(a),"1"==l.mode&&e(t).data("page-index",++i),e.fn.pullload.getTotalCount(a,l.countKey)?void(e.fn.pullload.getTotalCount(a,l.countKey)<=e(t).children().size()?(e.fn.pullload.tips(l.lastLoadedTips,t,l),e(l.handler).off("scroll.pullload")):(e(t).attr("requestable","true"),e.fn.pullload.closeTips(t,l))):void e.fn.pullload.tips("您的数据接口好像没有给出总条数嘛！",t,l)},error:function(a){e.fn.pullload.tips(l.loadFailedTips,t,l)}})}catch(s){e.fn.pullload.tips("错误名称："+s.name+"\n错误描述："+s.message)}},e.fn.pullload.tips=function(t,l,a){a.isShowLoadingTips&&(0===e(l).next("."+a.tipsClassName).size()&&e(l).after('<div class="'+a.tipsClassName+'"></div>'),e(l).next("."+a.tipsClassName).html(t),e(l).next("."+a.tipsClassName).slideDown(100))},e.fn.pullload.closeTips=function(t,l){l.isShowLoadingTips&&e(t).next("."+l.tipsClassName).slideUp(100)},e.fn.pullload.getTotalCount=function(e,t){var l=[];return t.indexOf(".")>0&&(l=t.split("."),l[0]&&l[1])?e[l[0]][l[1]]:e[t]},e.fn.pullload.defaults={handler:window,apiUrl:"",crossDoman:!1,requestType:"GET",callback:null,requestLoadedKey:"loaded",countKey:"count",tipsClassName:"data-status",loadingTips:"数据加载中...",lastLoadedTips:"已经加载到最后一页！",loadFailedTips:"数据加载失败，请重试！",threshold:50,isShowLoadingTips:!1,pageIndexKey:"pageIndex",pageSizeKey:"pageSize",pageSize:"10",mode:"1"}}(jQuery),define("components/pullload.js",function(){}),CreditsController.prototype.initPage=function(){var e=this;e.request(e.apiUrl.credits.get,{pageIndex:1,pageSize:e.pageSize},{showLoadingTips:!0,process:function(t){e.renderList(t),e.initPullLoad()}})},CreditsController.prototype.initPullLoad=function(){var e=this;require(["components/pullload.js"],function(){$(".credits-list").pullload({apiUrl:e.apiUrl.credits.get,threshold:15,crossDoman:!1,pageSize:e.pageSize,countKey:"data.count",callback:function(t){e.renderList(t.data,!0)}})})},CreditsController.prototype.renderList=function(e,t){var l=this,a=$(".credits-list");if(!t&&(a.empty(),!e.count)){var o='<div class="weui-loadmore weui-loadmore_line">';o+='<span class="weui-loadmore__tips">暂无数据</span>',o+="</div>",a.append(o)}$.each(e.rows,function(e,t){a.append(l.getItem(t))})},CreditsController.prototype.getItem=function(e){var t="",l="positive";return e.isPositive||(l="negative"),t+='<dl class="item">',t+="<dt>",t+="<h1>"+e.source.name+"</h1>",t+="<p>"+this.utcToLocal(e.createdAt)+"</p>",t+="</dt>",t+='<dd class="'+l+'">'+e.points+"</dd>",t+="</dl>",$(t)},$(function(){new CreditsController}),define("personal/credits",function(){});